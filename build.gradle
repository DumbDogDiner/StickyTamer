/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.6/userguide/tutorial_java_projects.html
 */

buildscript {
    repositories {
        google()
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:3.0.1'
        classpath 'com.guardsquare:proguard-gradle:7.0.0'
    }
}

plugins {
    // Apply the java plugin to add support for Java
    id 'java'

    // Apply the application plugin to add support for building a CLI application.
    id 'application'

    id 'kr.entree.spigradle' version '2.2.2'

    id 'com.github.johnrengelman.shadow' version '6.0.0'
}

group 'me.kokumaji'
version '2.0-DEV'
mainClassName = 'com.kokumaji.Tamer.Tamer'
compileJava.options.encoding = 'UTF-8'

repositories {

    // Default Gradle repositories
    jcenter()
    mavenCentral()

    // PaperMC repository
    maven {
        url 'https://papermc.io/repo/repository/maven-public/'
    }

    // PlaceholderAPI repository
    maven {
        url = 'https://repo.extendedclip.com/content/repositories/placeholderapi/'
    }

    // This is for bStats... cuz PlaceholderAPI doesnt like
    // being shadow jar'd without it...
    maven {
        url 'https://repo.codemc.org/repository/maven-public'
    }

}

dependencies {
    annotationProcessor 'org.projectlombok:lombok:1.18.12'

    // These are no Minecraft plugins, so
    // shadow them into the final jar!
    shadow "com.zaxxer:HikariCP:3.4.2"
    shadow files('libs/HibiscusAPI.jar')

    // Since this is a PaperMC plugin, there is
    // no need to shadow anything into the final jar
    compile files('libs/spigot-1.16.2.jar')
    compileOnly 'me.clip:placeholderapi:2.10.9'
}

// vv Configuring the Gradle plugins below vv

shadowJar {
    baseName = "${jar.archivePath}-shadow"
    classifier = ''
    archiveVersion = ''

    project.configurations.implementation.canBeResolved = true
    configurations = [project.configurations.shadow]
}

task obfuscate(type: proguard.gradle.ProGuardTask) {
    injars "${jar.archivePath}"
    outjars "${jar.archivePath}-obf.jar"

    libraryjars configurations.compileOnly
    libraryjars configurations.compile

    ignorewarnings

    keep 'public class me.kokumaji.Tamer.Tamer'
}

spigot {
    description 'A Entity Claim Plugin'
    authors 'Kokumaji'
    apiVersion '1.16'
    commands {
        tamer {
            description = 'Main Command'
            permission = 'tamer.command'
            permissionMessage = 'You do not have permission!'
            usage = '/<command>'
        }
    }
}
